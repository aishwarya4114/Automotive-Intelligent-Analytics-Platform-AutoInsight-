[2025-12-07T22:17:36.143+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: autoinsight_cleaning_pipeline.add_sentiment_analysis manual__2025-12-07T20:58:09.695467+00:00 [queued]>
[2025-12-07T22:17:36.157+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: autoinsight_cleaning_pipeline.add_sentiment_analysis manual__2025-12-07T20:58:09.695467+00:00 [queued]>
[2025-12-07T22:17:36.158+0000] {taskinstance.py:1361} INFO - Starting attempt 4 of 6
[2025-12-07T22:17:36.177+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): add_sentiment_analysis> on 2025-12-07 20:58:09.695467+00:00
[2025-12-07T22:17:36.186+0000] {standard_task_runner.py:57} INFO - Started process 227 to run task
[2025-12-07T22:17:36.191+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'autoinsight_cleaning_pipeline', 'add_sentiment_analysis', 'manual__2025-12-07T20:58:09.695467+00:00', '--job-id', '221', '--raw', '--subdir', 'DAGS_FOLDER/autoinsight_cleaning_pipeline.py', '--cfg-path', '/tmp/tmp86p8hxh9']
[2025-12-07T22:17:36.197+0000] {standard_task_runner.py:85} INFO - Job 221: Subtask add_sentiment_analysis
[2025-12-07T22:17:36.305+0000] {task_command.py:416} INFO - Running <TaskInstance: autoinsight_cleaning_pipeline.add_sentiment_analysis manual__2025-12-07T20:58:09.695467+00:00 [running]> on host fb35e4f278df
[2025-12-07T22:17:36.437+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='autoinsight@example.com' AIRFLOW_CTX_DAG_OWNER='autoinsight-team' AIRFLOW_CTX_DAG_ID='autoinsight_cleaning_pipeline' AIRFLOW_CTX_TASK_ID='add_sentiment_analysis' AIRFLOW_CTX_EXECUTION_DATE='2025-12-07T20:58:09.695467+00:00' AIRFLOW_CTX_TRY_NUMBER='4' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-12-07T20:58:09.695467+00:00'
[2025-12-07T22:17:36.439+0000] {logging_mixin.py:154} INFO - ======================================================================
[2025-12-07T22:17:36.440+0000] {logging_mixin.py:154} INFO - ADDING CUSTOM SENTIMENT ANALYSIS (Post-Processing)
[2025-12-07T22:17:36.440+0000] {logging_mixin.py:154} INFO - ======================================================================
[2025-12-07T22:17:42.975+0000] {logging_mixin.py:154} INFO - ======================================================================
[2025-12-07T22:17:42.977+0000] {logging_mixin.py:154} INFO - ADDING CUSTOM SENTIMENT ANALYSIS - FINAL FIXED VERSION
[2025-12-07T22:17:42.978+0000] {logging_mixin.py:154} INFO - ======================================================================
[2025-12-07T22:17:42.979+0000] {logging_mixin.py:154} INFO - 
Step 1: Connecting to Snowflake...
[2025-12-07T22:17:42.980+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.0, Python Version: 3.11.6, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[2025-12-07T22:17:42.982+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-12-07T22:17:44.887+0000] {logging_mixin.py:154} INFO - ✅ Connected to Snowflake
[2025-12-07T22:17:44.888+0000] {logging_mixin.py:154} INFO - 
Step 2: Verifying sentiment columns...
[2025-12-07T22:17:44.889+0000] {cursor.py:1032} INFO - query: [DESCRIBE TABLE FACT_COMPLAINTS]
[2025-12-07T22:17:44.976+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:17:44.978+0000] {cursor.py:1205} INFO - Number of results in first chunk: 34
[2025-12-07T22:17:44.980+0000] {logging_mixin.py:154} INFO - ✅ All sentiment columns exist
[2025-12-07T22:17:44.980+0000] {logging_mixin.py:154} INFO - 
Step 3: Checking complaints needing sentiment analysis...
[2025-12-07T22:17:44.981+0000] {cursor.py:1032} INFO - query: [SELECT COUNT(*) FROM FACT_COMPLAINTS WHERE sentiment_score IS NULL]
[2025-12-07T22:17:45.295+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:17:45.297+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:17:45.299+0000] {logging_mixin.py:154} INFO - Found 74,799 complaints needing sentiment analysis
[2025-12-07T22:17:45.300+0000] {logging_mixin.py:154} INFO - 
Step 4: Creating temporary staging table...
[2025-12-07T22:17:45.301+0000] {cursor.py:1032} INFO - query: [CREATE TEMP TABLE sentiment_staging ( complaint_id VARCHAR, sentiment_score FLOA...]
[2025-12-07T22:17:45.505+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:17:45.506+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:17:45.507+0000] {logging_mixin.py:154} INFO - ✅ Temp table created
[2025-12-07T22:17:45.508+0000] {logging_mixin.py:154} INFO - 
Step 5: Loading sentiment models...
[2025-12-07T22:17:45.508+0000] {logging_mixin.py:154} INFO - ⏳ This may take 1-2 minutes...
[2025-12-07T22:17:45.510+0000] {analyzer.py:29} INFO - Initializing ComplaintSentimentAnalyzer...
[2025-12-07T22:17:45.513+0000] {models.py:35} INFO - Loading sentiment model: cardiffnlp/twitter-roberta-base-sentiment-latest
[2025-12-07T22:17:45.521+0000] {logging_mixin.py:154} WARNING - /home/***/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:942 FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
[2025-12-07T22:17:47.067+0000] {logging_mixin.py:154} WARNING - Some weights of the model checkpoint at cardiffnlp/twitter-roberta-base-sentiment-latest were not used when initializing RobertaForSequenceClassification: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']
- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
[2025-12-07T22:17:47.363+0000] {models.py:50} INFO - ✅ Sentiment model loaded (device: CPU)
[2025-12-07T22:17:47.365+0000] {models.py:104} INFO - Loading embedding model: sentence-transformers/all-mpnet-base-v2
[2025-12-07T22:17:48.235+0000] {models.py:114} INFO - ✅ Embedding model loaded (device: cpu)
[2025-12-07T22:17:48.236+0000] {analyzer.py:36} INFO - ✅ ComplaintSentimentAnalyzer ready
[2025-12-07T22:17:48.237+0000] {logging_mixin.py:154} INFO - ✅ Models loaded in 2.7 seconds
[2025-12-07T22:17:48.237+0000] {logging_mixin.py:154} INFO - 
Step 6: Processing 74,799 complaints in 150 batches of 500...
[2025-12-07T22:17:48.238+0000] {logging_mixin.py:154} INFO - Using OPTIMIZED bulk update strategy with 500 complaints/batch
[2025-12-07T22:17:48.238+0000] {logging_mixin.py:154} INFO - ======================================================================
[2025-12-07T22:17:48.238+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:17:48.708+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:17:48.709+0000] {cursor.py:1205} INFO - Number of results in first chunk: 172
[2025-12-07T22:20:08.286+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:20:08.546+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:20:08.547+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:20:08.581+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( 'bbc5c47a669397b0a1fe448ecef00557851844b3...]
[2025-12-07T22:20:09.472+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:20:09.475+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:20:10.597+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:20:10.599+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:20:10.687+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:20:10.688+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:20:10.689+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:20:11.141+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:20:11.142+0000] {cursor.py:1205} INFO - Number of results in first chunk: 157
[2025-12-07T22:22:35.755+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:22:36.039+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:22:36.041+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:22:36.074+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( 'ce8c14d8b4650caeecb7ab63a3f7a65c00012457...]
[2025-12-07T22:22:37.036+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:22:37.039+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:22:38.018+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:22:38.019+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:22:38.083+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:22:38.085+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:22:38.085+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:22:38.501+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:22:38.502+0000] {cursor.py:1205} INFO - Number of results in first chunk: 169
[2025-12-07T22:24:54.107+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:24:54.454+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:24:54.457+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:24:54.508+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '4cf79c6b08e944efd2a12e60facd80eab45e1670...]
[2025-12-07T22:24:55.168+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:24:55.172+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:24:56.197+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:24:56.198+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:24:56.276+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:24:56.278+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:24:56.279+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:24:56.755+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:24:56.757+0000] {cursor.py:1205} INFO - Number of results in first chunk: 172
[2025-12-07T22:27:22.837+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:27:23.141+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:27:23.142+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:27:23.185+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '6942226a1c51c62b566f7682eb8a1d8b807472d1...]
[2025-12-07T22:27:24.366+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:27:24.369+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:27:25.425+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:27:25.427+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:27:25.520+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:27:25.521+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:27:25.522+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:27:25.976+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:27:25.979+0000] {cursor.py:1205} INFO - Number of results in first chunk: 185
[2025-12-07T22:29:39.808+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:29:40.146+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:29:40.148+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:29:40.178+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '24be92b7b4bbc04fe1ebd9bee39555b19988263e...]
[2025-12-07T22:29:40.865+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:29:40.868+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:29:41.786+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:29:41.788+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:29:41.866+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:29:41.868+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:29:41.870+0000] {logging_mixin.py:154} INFO -   Batch 5/150 | Processed: 2,500/74,799 (3.3%) | Speed: 3.5 complaints/sec | ETA: 5.7 hours
[2025-12-07T22:29:41.871+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:29:42.442+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:29:42.443+0000] {cursor.py:1205} INFO - Number of results in first chunk: 159
[2025-12-07T22:32:03.401+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:32:03.748+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:32:03.751+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:32:03.779+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '7cb22468d09bc524e5874c07322586b8196c6dba...]
[2025-12-07T22:32:05.258+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:32:05.260+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:32:06.275+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:32:06.278+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:32:06.363+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:32:06.370+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:32:06.376+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:32:06.927+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:32:06.928+0000] {cursor.py:1205} INFO - Number of results in first chunk: 174
[2025-12-07T22:34:38.424+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:34:38.951+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:34:38.952+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:34:38.983+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '93732567992366430881e4d0ec48f33268accf25...]
[2025-12-07T22:34:39.601+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:34:39.603+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:34:40.682+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:34:40.683+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:34:40.755+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:34:40.756+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:34:40.757+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:34:41.242+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:34:41.243+0000] {cursor.py:1205} INFO - Number of results in first chunk: 158
[2025-12-07T22:37:11.561+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:37:11.940+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:37:11.942+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:37:11.974+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( 'e4512dd375aaa122a818bd655ead691744b68f75...]
[2025-12-07T22:37:13.675+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:37:13.681+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:37:14.808+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:37:14.809+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:37:14.886+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:37:14.888+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:37:14.890+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:37:15.291+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:37:15.293+0000] {cursor.py:1205} INFO - Number of results in first chunk: 152
[2025-12-07T22:39:29.513+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:39:29.869+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:39:29.870+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:39:29.899+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '4f78640353cc16e7bf32b8d281e392312a00dbed...]
[2025-12-07T22:39:30.592+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:39:30.595+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:39:31.508+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:39:31.510+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:39:31.575+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:39:31.576+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:39:31.577+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:39:32.070+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:39:32.072+0000] {cursor.py:1205} INFO - Number of results in first chunk: 148
[2025-12-07T22:41:47.671+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:41:48.003+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:41:48.005+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:41:48.038+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( 'c30f43cb87608db62d453eb8676acba0444306c2...]
[2025-12-07T22:41:49.130+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:41:49.133+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:41:50.155+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:41:50.156+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:41:50.226+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:41:50.227+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:41:50.228+0000] {logging_mixin.py:154} INFO -   Batch 10/150 | Processed: 5,000/74,799 (6.7%) | Speed: 3.5 complaints/sec | ETA: 5.6 hours
[2025-12-07T22:41:50.230+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:41:50.747+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:41:50.749+0000] {cursor.py:1205} INFO - Number of results in first chunk: 151
[2025-12-07T22:44:08.483+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:44:08.821+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:44:08.823+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:44:08.857+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '756e65b64481fe07152ce9e11e53643ce426bd09...]
[2025-12-07T22:44:09.452+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:44:09.456+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:44:10.495+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:44:10.498+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:44:10.579+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:44:10.580+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:44:10.582+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:44:11.929+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:44:11.930+0000] {cursor.py:1205} INFO - Number of results in first chunk: 152
[2025-12-07T22:46:30.459+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:46:31.806+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:46:31.808+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:46:31.850+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '0f2aa6109362a86464569c94b1a4884b9a71e93d...]
[2025-12-07T22:46:32.758+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:46:32.761+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:46:33.852+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:46:33.853+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:46:33.927+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:46:33.936+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:46:33.945+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:46:34.367+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:46:34.371+0000] {cursor.py:1205} INFO - Number of results in first chunk: 157
[2025-12-07T22:48:46.968+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:48:47.197+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:48:47.198+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:48:47.223+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( 'b7258f2216dc1971f8729158cc844dac6c338104...]
[2025-12-07T22:48:47.868+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:48:47.871+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:48:48.997+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:48:48.998+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:48:49.058+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:48:49.060+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:48:49.061+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:48:49.543+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:48:49.545+0000] {cursor.py:1205} INFO - Number of results in first chunk: 141
[2025-12-07T22:51:08.701+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:51:09.076+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:51:09.373+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:51:09.407+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '1c334ff4aaa9b7e1aca143c3a3a91a7380d3ecec...]
[2025-12-07T22:51:10.101+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:51:10.126+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:51:11.062+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:51:11.063+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:51:11.226+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:51:11.227+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:51:11.228+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:51:11.912+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:51:11.913+0000] {cursor.py:1205} INFO - Number of results in first chunk: 149
[2025-12-07T22:53:27.637+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:53:27.879+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:53:27.881+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:53:27.915+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( 'e2c369be54a97a152a7dabb1ef2bfdc572f32bfd...]
[2025-12-07T22:53:28.551+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:53:28.554+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:53:29.655+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:53:29.661+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:53:29.749+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:53:29.750+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:53:29.752+0000] {logging_mixin.py:154} INFO -   Batch 15/150 | Processed: 7,500/74,799 (10.0%) | Speed: 3.5 complaints/sec | ETA: 5.4 hours
[2025-12-07T22:53:29.753+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:53:30.220+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:53:30.221+0000] {cursor.py:1205} INFO - Number of results in first chunk: 168
[2025-12-07T22:55:34.205+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:55:34.500+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:55:34.501+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:55:34.532+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '953fb4389ee1360f9b714c210fb1abf8def45731...]
[2025-12-07T22:55:35.520+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:55:35.523+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:55:36.750+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:55:36.752+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:55:36.830+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:55:36.831+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:55:36.833+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:55:37.261+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:55:37.262+0000] {cursor.py:1205} INFO - Number of results in first chunk: 150
[2025-12-07T22:57:53.197+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T22:57:53.557+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:57:53.561+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:57:53.593+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '8288efad2ed3cb552e47760384215212efe68ede...]
[2025-12-07T22:57:54.271+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:57:54.273+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T22:57:55.193+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:57:55.195+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T22:57:55.296+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:57:55.297+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T22:57:55.298+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T22:57:56.159+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T22:57:56.161+0000] {cursor.py:1205} INFO - Number of results in first chunk: 163
[2025-12-07T23:00:01.985+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T23:00:02.381+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:00:02.384+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T23:00:02.425+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '1abba3f5ef1f4ac1af621c669c5813ffdb7b8b91...]
[2025-12-07T23:00:03.808+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:00:03.813+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T23:00:04.937+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:00:04.940+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T23:00:05.073+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:00:05.078+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T23:00:05.081+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T23:00:05.518+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:00:05.519+0000] {cursor.py:1205} INFO - Number of results in first chunk: 150
[2025-12-07T23:02:09.108+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T23:02:09.405+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:02:09.407+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T23:02:09.432+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '4d12b2e28e863cf86a9331e2301cdc0ad54e00a3...]
[2025-12-07T23:02:10.065+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:02:10.068+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T23:02:11.087+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:02:11.089+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T23:02:11.155+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:02:11.157+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T23:02:11.158+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T23:02:11.637+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:02:11.639+0000] {cursor.py:1205} INFO - Number of results in first chunk: 133
[2025-12-07T23:04:17.760+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T23:04:18.165+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:04:18.166+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T23:04:18.193+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '98fbd8384c0f001212f64972e617fb373115d3f6...]
[2025-12-07T23:04:19.187+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:04:19.190+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T23:04:20.091+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:04:20.092+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T23:04:20.159+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:04:20.161+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T23:04:20.162+0000] {logging_mixin.py:154} INFO -   Batch 20/150 | Processed: 10,000/74,799 (13.4%) | Speed: 3.6 complaints/sec | ETA: 5.0 hours
[2025-12-07T23:04:20.163+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T23:04:20.561+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:04:20.562+0000] {cursor.py:1205} INFO - Number of results in first chunk: 148
[2025-12-07T23:06:29.820+0000] {cursor.py:1032} INFO - query: [TRUNCATE TABLE sentiment_staging]
[2025-12-07T23:06:30.158+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:06:30.159+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T23:06:30.192+0000] {cursor.py:1032} INFO - query: [INSERT INTO sentiment_staging VALUES ( '56070bb510e91a9e257ba253e999749726e43983...]
[2025-12-07T23:06:30.874+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:06:30.877+0000] {cursor.py:1032} INFO - query: [MERGE INTO FACT_COMPLAINTS f USING sentiment_staging s ON f.complaint_id = s.com...]
[2025-12-07T23:06:32.208+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:06:32.209+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2025-12-07T23:06:32.475+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:06:32.477+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2025-12-07T23:06:32.479+0000] {cursor.py:1032} INFO - query: [SELECT complaint_id, complaint_description FROM FACT_COMPLAINTS WHERE sentiment_...]
[2025-12-07T23:06:32.965+0000] {cursor.py:1045} INFO - query execution done
[2025-12-07T23:06:32.966+0000] {cursor.py:1205} INFO - Number of results in first chunk: 140
[2025-12-08T17:45:36.309+0000] {local_task_job_runner.py:294} WARNING - State of this instance has been externally set to up_for_retry. Terminating instance.
[2025-12-08T17:45:36.538+0000] {process_utils.py:131} INFO - Sending 15 to group 227. PIDs of all processes in the group: [227]
[2025-12-08T17:45:36.576+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 227
[2025-12-08T17:45:36.633+0000] {taskinstance.py:1632} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-12-08T17:45:36.693+0000] {logging_mixin.py:154} INFO - ❌ Sentiment Analysis Failed: Task received SIGTERM signal
[2025-12-08T17:45:37.069+0000] {logging_mixin.py:154} WARNING - Traceback (most recent call last):
[2025-12-08T17:45:37.116+0000] {logging_mixin.py:154} WARNING -   File "/opt/***/dags/autoinsight_cleaning_pipeline.py", line 406, in add_sentiment_to_complaints
    sentiment_main()
[2025-12-08T17:45:37.189+0000] {logging_mixin.py:154} WARNING -   File "/opt/***/src/add_sentiment_to_snowflake.py", line 165, in main
    sentiment_results = process_sentiment_batch(batch_df, analyzer)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.264+0000] {logging_mixin.py:154} WARNING -   File "/opt/***/src/add_sentiment_to_snowflake.py", line 27, in process_sentiment_batch
    result = analyzer.analyze(text)
             ^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.337+0000] {logging_mixin.py:154} WARNING -   File "/opt/***/src/sentiment/analyzer.py", line 77, in analyze
    sentiment_score, label, confidence = self.sentiment_model.predict(text)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.463+0000] {logging_mixin.py:154} WARNING -   File "/opt/***/src/sentiment/models.py", line 72, in predict
    result = self.pipeline(text)[0]
             ^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.519+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/pipelines/text_classification.py", line 156, in __call__
    result = super().__call__(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.565+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/pipelines/base.py", line 1140, in __call__
    return self.run_single(inputs, preprocess_params, forward_params, postprocess_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.645+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/pipelines/base.py", line 1147, in run_single
    model_outputs = self.forward(model_inputs, **forward_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.744+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/pipelines/base.py", line 1046, in forward
    model_outputs = self._forward(model_inputs, **forward_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.825+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/pipelines/text_classification.py", line 187, in _forward
    return self.model(**model_inputs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.857+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.873+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:37.930+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 1198, in forward
    outputs = self.roberta(
              ^^^^^^^^^^^^^
[2025-12-08T17:45:37.968+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.094+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.130+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 835, in forward
    encoder_outputs = self.encoder(
                      ^^^^^^^^^^^^^
[2025-12-08T17:45:38.183+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.246+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.297+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 524, in forward
    layer_outputs = layer_module(
                    ^^^^^^^^^^^^^
[2025-12-08T17:45:38.337+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.358+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.416+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 413, in forward
    self_attention_outputs = self.attention(
                             ^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.421+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.458+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.507+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 340, in forward
    self_outputs = self.self(
                   ^^^^^^^^^^
[2025-12-08T17:45:38.537+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.540+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.599+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 266, in forward
    attention_probs = nn.functional.softmax(attention_scores, dim=-1)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.639+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/torch/nn/functional.py", line 1856, in softmax
    ret = input.softmax(dim)
          ^^^^^^^^^^^^^^^^^^
[2025-12-08T17:45:38.682+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/***/models/taskinstance.py", line 1634, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
[2025-12-08T17:45:38.734+0000] {logging_mixin.py:154} WARNING - ***.exceptions.AirflowException: Task received SIGTERM signal
[2025-12-08T17:45:38.895+0000] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/autoinsight_cleaning_pipeline.py", line 406, in add_sentiment_to_complaints
    sentiment_main()
  File "/opt/airflow/src/add_sentiment_to_snowflake.py", line 165, in main
    sentiment_results = process_sentiment_batch(batch_df, analyzer)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/src/add_sentiment_to_snowflake.py", line 27, in process_sentiment_batch
    result = analyzer.analyze(text)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/src/sentiment/analyzer.py", line 77, in analyze
    sentiment_score, label, confidence = self.sentiment_model.predict(text)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/src/sentiment/models.py", line 72, in predict
    result = self.pipeline(text)[0]
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/pipelines/text_classification.py", line 156, in __call__
    result = super().__call__(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/pipelines/base.py", line 1140, in __call__
    return self.run_single(inputs, preprocess_params, forward_params, postprocess_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/pipelines/base.py", line 1147, in run_single
    model_outputs = self.forward(model_inputs, **forward_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/pipelines/base.py", line 1046, in forward
    model_outputs = self._forward(model_inputs, **forward_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/pipelines/text_classification.py", line 187, in _forward
    return self.model(**model_inputs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 1198, in forward
    outputs = self.roberta(
              ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 835, in forward
    encoder_outputs = self.encoder(
                      ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 524, in forward
    layer_outputs = layer_module(
                    ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 413, in forward
    self_attention_outputs = self.attention(
                             ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 340, in forward
    self_outputs = self.self(
                   ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/transformers/models/roberta/modeling_roberta.py", line 266, in forward
    attention_probs = nn.functional.softmax(attention_scores, dim=-1)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/torch/nn/functional.py", line 1856, in softmax
    ret = input.softmax(dim)
          ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 1634, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2025-12-08T17:45:39.317+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=autoinsight_cleaning_pipeline, task_id=add_sentiment_analysis, execution_date=20251207T205809, start_date=20251207T221736, end_date=20251208T174539
[2025-12-08T17:45:39.436+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 221 for task add_sentiment_analysis (Task received SIGTERM signal; 227)
[2025-12-08T17:45:40.030+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=227, status='terminated', exitcode=1, started='22:17:35') (227) terminated with exit code 1
