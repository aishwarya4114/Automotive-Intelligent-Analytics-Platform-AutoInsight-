[2025-12-07T01:55:45.717+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: autoinsight_cleaning_pipeline.clean_nhtsa_complaints manual__2025-12-07T01:55:44.575398+00:00 [queued]>
[2025-12-07T01:55:45.729+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: autoinsight_cleaning_pipeline.clean_nhtsa_complaints manual__2025-12-07T01:55:44.575398+00:00 [queued]>
[2025-12-07T01:55:45.730+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 3
[2025-12-07T01:55:45.752+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): clean_nhtsa_complaints> on 2025-12-07 01:55:44.575398+00:00
[2025-12-07T01:55:45.765+0000] {standard_task_runner.py:57} INFO - Started process 244 to run task
[2025-12-07T01:55:45.770+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'autoinsight_cleaning_pipeline', 'clean_nhtsa_complaints', 'manual__2025-12-07T01:55:44.575398+00:00', '--job-id', '166', '--raw', '--subdir', 'DAGS_FOLDER/autoinsight_cleaning_pipeline.py', '--cfg-path', '/tmp/tmps6k2x9an']
[2025-12-07T01:55:45.780+0000] {standard_task_runner.py:85} INFO - Job 166: Subtask clean_nhtsa_complaints
[2025-12-07T01:55:45.876+0000] {task_command.py:416} INFO - Running <TaskInstance: autoinsight_cleaning_pipeline.clean_nhtsa_complaints manual__2025-12-07T01:55:44.575398+00:00 [running]> on host fb35e4f278df
[2025-12-07T01:55:46.011+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='autoinsight@example.com' AIRFLOW_CTX_DAG_OWNER='autoinsight-team' AIRFLOW_CTX_DAG_ID='autoinsight_cleaning_pipeline' AIRFLOW_CTX_TASK_ID='clean_nhtsa_complaints' AIRFLOW_CTX_EXECUTION_DATE='2025-12-07T01:55:44.575398+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-12-07T01:55:44.575398+00:00'
[2025-12-07T01:55:46.013+0000] {logging_mixin.py:154} INFO - ======================================================================
[2025-12-07T01:55:46.014+0000] {logging_mixin.py:154} INFO - CLEANING TASK 3B: NHTSA Complaints
[2025-12-07T01:55:46.015+0000] {logging_mixin.py:154} INFO - ======================================================================
[2025-12-07T01:55:46.265+0000] {logging_mixin.py:154} INFO - 
Starting NHTSA Complaints Cleaning
[2025-12-07T01:55:46.266+0000] {logging_mixin.py:154} INFO - Running in LOCAL mode
[2025-12-07T01:55:46.267+0000] {logging_mixin.py:154} INFO - Loading AWS S3 connectors...
[2025-12-07T01:56:02.242+0000] {logging_mixin.py:154} INFO - Input: s3a://autoinsightfinal/nhtsa/raw/complaints/*.csv
[2025-12-07T01:56:02.243+0000] {logging_mixin.py:154} INFO - Output: s3a://autoinsightfinal/nhtsa/cleaned_new/complaints/parquet/
[2025-12-07T01:56:02.243+0000] {logging_mixin.py:154} INFO - ============================================================
[2025-12-07T01:56:02.246+0000] {logging_mixin.py:154} INFO - NHTSA COMPLAINTS - SPARK CLEANING PIPELINE
[2025-12-07T01:56:02.247+0000] {logging_mixin.py:154} INFO - Input: 2020-2025 data (pre-filtered)
[2025-12-07T01:56:02.247+0000] {logging_mixin.py:154} INFO - Target: Top 15 manufacturers
[2025-12-07T01:56:02.248+0000] {logging_mixin.py:154} INFO - Output: Snowflake-ready (sentiment added later)
[2025-12-07T01:56:02.248+0000] {logging_mixin.py:154} INFO - ============================================================
[2025-12-07T01:56:02.249+0000] {logging_mixin.py:154} INFO - 
Reading raw data from: s3a://autoinsightfinal/nhtsa/raw/complaints/*.csv
[2025-12-07T01:56:42.719+0000] {logging_mixin.py:154} INFO -   Loaded 227,011 records
[2025-12-07T01:56:42.720+0000] {logging_mixin.py:154} INFO -   Initial columns: 50
[2025-12-07T01:56:42.721+0000] {logging_mixin.py:154} INFO - 
Step 1: Standardizing manufacturer names...
[2025-12-07T01:56:44.466+0000] {logging_mixin.py:154} INFO - 
Step 2: Filtering to top 15 manufacturers...
[2025-12-07T01:56:44.819+0000] {logging_mixin.py:154} INFO -   ðŸ“Š Filtering to top 15 manufacturers...
[2025-12-07T01:57:08.703+0000] {logging_mixin.py:154} INFO -   âœ“ Kept 226,993 records from top 15 manufacturers
[2025-12-07T01:57:08.705+0000] {logging_mixin.py:154} INFO -   âœ“ Filtered out 11 records from other manufacturers
[2025-12-07T01:57:08.706+0000] {logging_mixin.py:154} INFO - 
Step 3: Validating YEAR field...
[2025-12-07T01:57:08.903+0000] {logging_mixin.py:154} INFO - 
Step 4: Cleaning MODEL field...
[2025-12-07T01:57:09.198+0000] {logging_mixin.py:154} INFO - 
Step 5: Cleaning date fields...
[2025-12-07T01:57:09.364+0000] {logging_mixin.py:154} INFO - 
Step 6: Converting Y/N fields to boolean...
[2025-12-07T01:57:10.106+0000] {logging_mixin.py:154} INFO - 
Step 7: Converting numeric fields...
[2025-12-07T01:57:10.452+0000] {logging_mixin.py:154} INFO - 
Step 8: Cleaning text fields...
[2025-12-07T01:57:10.996+0000] {logging_mixin.py:154} INFO - 
Step 9: Creating severity level...
[2025-12-07T01:57:11.125+0000] {logging_mixin.py:154} INFO - 
Step 10: Adding data quality flags...
[2025-12-07T01:57:11.182+0000] {logging_mixin.py:154} INFO - 
Step 11: Removing duplicates...
[2025-12-07T01:57:33.990+0000] {logging_mixin.py:154} INFO -   Removed 0 duplicate records
[2025-12-07T01:57:33.993+0000] {logging_mixin.py:154} INFO - 
Step 12: Standardizing column names for Snowflake...
[2025-12-07T01:57:34.354+0000] {logging_mixin.py:154} INFO - 
Step 13: Creating standardized vehicle_id...
[2025-12-07T01:57:34.864+0000] {logging_mixin.py:154} INFO - 
Step 14: Adding metadata...
[2025-12-07T01:57:35.031+0000] {logging_mixin.py:154} INFO - 
Step 15: Selecting final columns (Snowflake-ready)...
[2025-12-07T01:57:47.054+0000] {logging_mixin.py:154} INFO - 
Cleaning Summary:
[2025-12-07T01:57:47.055+0000] {logging_mixin.py:154} INFO -   Initial records: 227,011
[2025-12-07T01:57:47.056+0000] {logging_mixin.py:154} INFO -   Final records: 74,799
[2025-12-07T01:57:47.057+0000] {logging_mixin.py:154} INFO -   Retention rate: 32.9%
[2025-12-07T01:57:47.057+0000] {logging_mixin.py:154} INFO -   Final columns: 34
[2025-12-07T01:57:47.058+0000] {logging_mixin.py:154} INFO - 
Severity Distribution:
[2025-12-07T01:57:58.393+0000] {logging_mixin.py:154} INFO -   LOW: 68,415
[2025-12-07T01:57:58.394+0000] {logging_mixin.py:154} INFO -   MEDIUM: 3,743
[2025-12-07T01:57:58.395+0000] {logging_mixin.py:154} INFO -   HIGH: 2,567
[2025-12-07T01:57:58.396+0000] {logging_mixin.py:154} INFO -   CRITICAL: 74
[2025-12-07T01:57:58.396+0000] {logging_mixin.py:154} INFO - 
Manufacturer Distribution:
[2025-12-07T01:58:09.254+0000] {logging_mixin.py:154} INFO -   Ford: 12,572
[2025-12-07T01:58:09.255+0000] {logging_mixin.py:154} INFO -   Tesla: 9,226
[2025-12-07T01:58:09.257+0000] {logging_mixin.py:154} INFO -   Honda: 8,057
[2025-12-07T01:58:09.257+0000] {logging_mixin.py:154} INFO -   Hyundai: 5,978
[2025-12-07T01:58:09.258+0000] {logging_mixin.py:154} INFO -   Jeep: 5,791
[2025-12-07T01:58:09.259+0000] {logging_mixin.py:154} INFO -   Toyota: 5,685
[2025-12-07T01:58:09.260+0000] {logging_mixin.py:154} INFO -   Chevrolet: 5,182
[2025-12-07T01:58:09.261+0000] {logging_mixin.py:154} INFO -   Kia: 4,809
[2025-12-07T01:58:09.263+0000] {logging_mixin.py:154} INFO -   Subaru: 4,195
[2025-12-07T01:58:09.264+0000] {logging_mixin.py:154} INFO -   Volkswagen: 3,764
[2025-12-07T01:58:09.265+0000] {logging_mixin.py:154} INFO -   Nissan: 3,150
[2025-12-07T01:58:09.265+0000] {logging_mixin.py:154} INFO -   GMC: 2,192
[2025-12-07T01:58:09.266+0000] {logging_mixin.py:154} INFO -   Mercedes-Benz: 1,715
[2025-12-07T01:58:09.266+0000] {logging_mixin.py:154} INFO -   BMW: 1,460
[2025-12-07T01:58:09.267+0000] {logging_mixin.py:154} INFO -   Mazda: 1,023
[2025-12-07T01:58:09.268+0000] {logging_mixin.py:154} INFO - 
Preparing to write cleaned data...
[2025-12-07T01:58:09.443+0000] {logging_mixin.py:154} INFO -    Safety check: Will not delete from non-cleaned path: s3a://autoinsightfinal/nhtsa/cleaned_new/complaints/parquet/
[2025-12-07T01:58:09.444+0000] {logging_mixin.py:154} INFO - Writing cleaned data to: s3a://autoinsightfinal/nhtsa/cleaned_new/complaints/parquet/
[2025-12-07T01:59:11.009+0000] {logging_mixin.py:154} INFO -    Safety check: Will not delete from non-cleaned path: s3a://autoinsightfinal/nhtsa/cleaned_new/complaints/csv/
[2025-12-07T01:59:11.011+0000] {logging_mixin.py:154} INFO - Writing CSV to: s3a://autoinsightfinal/nhtsa/cleaned_new/complaints/csv/
[2025-12-07T01:59:35.558+0000] {logging_mixin.py:154} INFO - 
âœ… Complaints cleaning complete!
[2025-12-07T01:59:35.559+0000] {logging_mixin.py:154} INFO - NOTE: Sentiment analysis will be added after loading to Snowflake
[2025-12-07T01:59:35.562+0000] {logging_mixin.py:154} INFO - ============================================================
[2025-12-07T01:59:35.563+0000] {logging_mixin.py:154} INFO - 
Sample of cleaned data:
[2025-12-07T01:59:46.039+0000] {logging_mixin.py:154} INFO - +----------------------------------------------------------------+---------+--------------+----+--------------+------------+
|complaint_id                                                    |make     |model         |year|severity_level|has_incident|
+----------------------------------------------------------------+---------+--------------+----+--------------+------------+
|6942226a1c51c62b566f7682eb8a1d8b807472d1b974c1e8c616b9bcdda527c4|Kia      |TELLURIDE     |2020|LOW           |false       |
|93732567992366430881e4d0ec48f33268accf25a742929d1cb462be0b0e270d|Kia      |SOUL          |2020|LOW           |false       |
|ce8c14d8b4650caeecb7ab63a3f7a65c00012457142f75206fc157680768af3a|Jeep     |WRANGLER      |2020|LOW           |false       |
|36b8edad90a849f12d77037b15b0adb879249734d84896e089e366667cf2fc74|Kia      |SOUL          |2020|LOW           |false       |
|55d3f2807171ec52212bdea05720497efadde06e0ffa2bc2936087293159023e|Subaru   |ASCENT        |2020|LOW           |false       |
|e4512dd375aaa122a818bd655ead691744b68f75e6b2704dfdf63e25e24a1bb5|Honda    |PILOT         |2020|LOW           |false       |
|24be92b7b4bbc04fe1ebd9bee39555b19988263eadf5f4b9f6bdac6770d11392|Honda    |PILOT         |2020|LOW           |false       |
|1d58246746ca93839711631fe2310cdf3662eeb037d51425114720ce6f75ee23|Chevrolet|SILVERADO 1500|2020|LOW           |false       |
|6f1412859e79ade562ec1e61baa923d2555af0200d093a2fa7e83a64299dfd00|Subaru   |OUTBACK       |2020|LOW           |false       |
|4cf79c6b08e944efd2a12e60facd80eab45e167017f9732dcca2bdfea85c5d96|Tesla    |MODEL 3       |2020|LOW           |false       |
+----------------------------------------------------------------+---------+--------------+----+--------------+------------+
only showing top 10 rows
[2025-12-07T01:59:46.040+0000] {logging_mixin.py:154} INFO - 
Vehicle ID verification (first 5):
[2025-12-07T01:59:56.557+0000] {logging_mixin.py:154} INFO - +----------------------------------------------------------------+----+---------+----+
|vehicle_id                                                      |make|model    |year|
+----------------------------------------------------------------+----+---------+----+
|db0dbaf0de68f3b0a1e9108a1f77447ca2b6120c1aa408f2f108d1ad5f08dc4c|Kia |TELLURIDE|2020|
|db0dbaf0de68f3b0a1e9108a1f77447ca2b6120c1aa408f2f108d1ad5f08dc4c|Kia |TELLURIDE|2020|
|ab6fb0fc38144fb01d77fc2eb9f4e36e6de08481a21a74d499dbc1b202d974f0|Kia |SOUL     |2020|
|c07d764586397a495186081dabd0b8ea8c7e6a50567fb57c444090fb469c4111|Jeep|WRANGLER |2020|
|ab6fb0fc38144fb01d77fc2eb9f4e36e6de08481a21a74d499dbc1b202d974f0|Kia |SOUL     |2020|
+----------------------------------------------------------------+----+---------+----+
only showing top 5 rows
[2025-12-07T01:59:56.884+0000] {logging_mixin.py:154} INFO - âœ… NHTSA Complaints Cleaning Complete
[2025-12-07T01:59:56.911+0000] {python.py:194} INFO - Done. Returned value was: True
[2025-12-07T01:59:56.939+0000] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=autoinsight_cleaning_pipeline, task_id=clean_nhtsa_complaints, execution_date=20251207T015544, start_date=20251207T015545, end_date=20251207T015956
[2025-12-07T01:59:56.994+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-12-07T01:59:57.033+0000] {taskinstance.py:2778} INFO - 1 downstream tasks scheduled from follow-on schedule check
