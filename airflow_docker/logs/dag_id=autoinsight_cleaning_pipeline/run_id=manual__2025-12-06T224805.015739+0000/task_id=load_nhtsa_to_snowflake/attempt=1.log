[2025-12-06T23:04:17.038+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: autoinsight_cleaning_pipeline.load_nhtsa_to_snowflake manual__2025-12-06T22:48:05.015739+00:00 [queued]>
[2025-12-06T23:04:17.045+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: autoinsight_cleaning_pipeline.load_nhtsa_to_snowflake manual__2025-12-06T22:48:05.015739+00:00 [queued]>
[2025-12-06T23:04:17.046+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 3
[2025-12-06T23:04:17.056+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): load_nhtsa_to_snowflake> on 2025-12-06 22:48:05.015739+00:00
[2025-12-06T23:04:17.060+0000] {standard_task_runner.py:57} INFO - Started process 4300 to run task
[2025-12-06T23:04:17.064+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'autoinsight_cleaning_pipeline', 'load_nhtsa_to_snowflake', 'manual__2025-12-06T22:48:05.015739+00:00', '--job-id', '118', '--raw', '--subdir', 'DAGS_FOLDER/autoinsight_cleaning_pipeline.py', '--cfg-path', '/tmp/tmpeghld_bp']
[2025-12-06T23:04:17.067+0000] {standard_task_runner.py:85} INFO - Job 118: Subtask load_nhtsa_to_snowflake
[2025-12-06T23:04:17.128+0000] {task_command.py:416} INFO - Running <TaskInstance: autoinsight_cleaning_pipeline.load_nhtsa_to_snowflake manual__2025-12-06T22:48:05.015739+00:00 [running]> on host a568c43bff1e
[2025-12-06T23:04:17.190+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='autoinsight@example.com' AIRFLOW_CTX_DAG_OWNER='autoinsight-team' AIRFLOW_CTX_DAG_ID='autoinsight_cleaning_pipeline' AIRFLOW_CTX_TASK_ID='load_nhtsa_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2025-12-06T22:48:05.015739+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-12-06T22:48:05.015739+00:00'
[2025-12-06T23:04:17.193+0000] {logging_mixin.py:154} INFO - ======================================================================
[2025-12-06T23:04:17.196+0000] {logging_mixin.py:154} INFO - SNOWFLAKE LOAD: All NHTSA Datasets
[2025-12-06T23:04:17.200+0000] {logging_mixin.py:154} INFO - ======================================================================
[2025-12-06T23:04:17.993+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.0, Python Version: 3.11.6, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[2025-12-06T23:04:17.994+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-12-06T23:04:19.249+0000] {credentials.py:1147} INFO - Found credentials in environment variables.
[2025-12-06T23:04:19.305+0000] {logging_mixin.py:154} INFO - 
============================================================
[2025-12-06T23:04:19.306+0000] {logging_mixin.py:154} INFO - Processing FACT_RECALLS
[2025-12-06T23:04:19.307+0000] {logging_mixin.py:154} INFO - ============================================================
[2025-12-06T23:04:19.307+0000] {logging_mixin.py:154} INFO - Looking for CSV files in: s3://autoinsightfinal/nhtsa/cleaned_new/recalls/csv/
[2025-12-06T23:04:19.742+0000] {logging_mixin.py:154} INFO - Reading CSV: s3://autoinsightfinal/nhtsa/cleaned_new/recalls/csv/part-00000-0915b03a-3576-498f-a5a9-0bf3758b581b-c000.csv
[2025-12-06T23:04:20.019+0000] {logging_mixin.py:154} INFO - ‚ùå NHTSA Snowflake Load Failed: Error tokenizing data. C error: Expected 14 fields in line 307, saw 15
[2025-12-06T23:04:20.027+0000] {logging_mixin.py:154} WARNING - Traceback (most recent call last):
[2025-12-06T23:04:20.028+0000] {logging_mixin.py:154} WARNING -   File "/opt/***/dags/autoinsight_cleaning_pipeline.py", line 427, in load_to_snowflake_nhtsa
    df = pd.read_csv(BytesIO(obj['Body'].read()))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-06T23:04:20.029+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 948, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-06T23:04:20.029+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 617, in _read
    return parser.read(nrows)
           ^^^^^^^^^^^^^^^^^^
[2025-12-06T23:04:20.029+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1748, in read
    ) = self._engine.read(  # type: ignore[attr-defined]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-06T23:04:20.030+0000] {logging_mixin.py:154} WARNING -   File "/home/***/.local/lib/python3.11/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 234, in read
    chunks = self._reader.read_low_memory(nrows)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-12-06T23:04:20.030+0000] {logging_mixin.py:154} WARNING -   File "parsers.pyx", line 843, in pandas._libs.parsers.TextReader.read_low_memory
[2025-12-06T23:04:20.030+0000] {logging_mixin.py:154} WARNING -   File "parsers.pyx", line 904, in pandas._libs.parsers.TextReader._read_rows
[2025-12-06T23:04:20.031+0000] {logging_mixin.py:154} WARNING -   File "parsers.pyx", line 879, in pandas._libs.parsers.TextReader._tokenize_rows
[2025-12-06T23:04:20.031+0000] {logging_mixin.py:154} WARNING -   File "parsers.pyx", line 890, in pandas._libs.parsers.TextReader._check_tokenize_status
[2025-12-06T23:04:20.031+0000] {logging_mixin.py:154} WARNING -   File "parsers.pyx", line 2058, in pandas._libs.parsers.raise_parser_error
[2025-12-06T23:04:20.031+0000] {logging_mixin.py:154} WARNING - pandas.errors.ParserError: Error tokenizing data. C error: Expected 14 fields in line 307, saw 15
[2025-12-06T23:04:20.032+0000] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/autoinsight_cleaning_pipeline.py", line 427, in load_to_snowflake_nhtsa
    df = pd.read_csv(BytesIO(obj['Body'].read()))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 948, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 617, in _read
    return parser.read(nrows)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1748, in read
    ) = self._engine.read(  # type: ignore[attr-defined]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 234, in read
    chunks = self._reader.read_low_memory(nrows)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "parsers.pyx", line 843, in pandas._libs.parsers.TextReader.read_low_memory
  File "parsers.pyx", line 904, in pandas._libs.parsers.TextReader._read_rows
  File "parsers.pyx", line 879, in pandas._libs.parsers.TextReader._tokenize_rows
  File "parsers.pyx", line 890, in pandas._libs.parsers.TextReader._check_tokenize_status
  File "parsers.pyx", line 2058, in pandas._libs.parsers.raise_parser_error
pandas.errors.ParserError: Error tokenizing data. C error: Expected 14 fields in line 307, saw 15

[2025-12-06T23:04:20.043+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=autoinsight_cleaning_pipeline, task_id=load_nhtsa_to_snowflake, execution_date=20251206T224805, start_date=20251206T230417, end_date=20251206T230420
[2025-12-06T23:04:20.055+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 118 for task load_nhtsa_to_snowflake (Error tokenizing data. C error: Expected 14 fields in line 307, saw 15
; 4300)
[2025-12-06T23:04:20.087+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2025-12-06T23:04:20.100+0000] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
